\documentclass[12pt,fleqn]{article}
\input{/home/masarati/Docs/Latex-tools/stdmacro.tex}

\begin{document}

\title{Scalar Filter}
\author{Pierangelo Masarati}
\date{}
\maketitle

Consider a filter in the rational form
\begin{displaymath}
    y\plbr{s} \ = \ \frac{
        b_0 + b_1 s + {\ldots} + b_{nb} s^{nb}
    }{
        a_0 + a_1 s + {\ldots} + a_{na} s^{na}
    } u\plbr{s}
\end{displaymath}
with $na\geq{nb}$.
It can be realized in the state space form
\begin{displaymath}
    \cubr{\cvvect{
        \dot{x}_0 \\
	\dot{x}_1 \\
	\vdots \\
	\dot{x}_{na-1}
    }} \ = \ \sqbr{\matr{cccc}{
        0 & {\ldots} & 0 & \alpha_0 \\
	1 & {\ldots} & 0 & \alpha_1 \\
	\vdots & \ddots & \vdots & \vdots \\
	0 & {\ldots} & 1 & \alpha_{na-1}
    }}\cubr{\cvvect{
        x_0 \\
	x_1 \\
	\vdots \\
	x_{na-1}
    }} + \cubr{\cvvect{
        \beta_0 \\
	\beta_1 \\
	\vdots \\
	\beta_{na-1}
    }}
\end{displaymath}
\begin{displaymath}
    y \ = \ \sqbr{\matr{cccc}{
        0 & {\ldots} & 0 & 1
    }}\cubr{\cvvect{
        x_0 \\
	x_1 \\
	\vdots \\
	x_{na-1}
    }} + \beta_{na} u
\end{displaymath}
By differentiating each row of the state equation as many times as the row
index, the following relation results
\begin{eqnarray*}
    \dot{x}_0 & = & \alpha_0 x_{na-1} + \beta_0 u \\
    \ddot{x}_1 & = & \dot{x}_0 + \alpha_1 \dot{x}_{na-1} + \beta_1 \dot{u} \\
    & & {\ldots} \\
    x_{na-2}^{\plbr{na-1}} & = & 
        x_{na-3}^{\plbr{na-2}} + \alpha_{na-2} x_{na-1}^{\plbr{na-2}}
	+ \beta_{na-2} u^{\plbr{na-2}} \\
    x_{na-1}^{\plbr{na}} & = & 
        x_{na-2}^{\plbr{na-1}} + \alpha_{na-1} x_{na-1}^{\plbr{na-1}}
	+ \beta_{na-1} u^{\plbr{na-1}}
\end{eqnarray*}
by considering the last equation, and by recursively substituting each of
the preceding equations into it, the following relation results
\begin{eqnarray*}
    x_{na-1}^{\plbr{na}} & = & 
        \alpha_0 x_{na-1}^{\plbr{0}} + \beta_0 u^{\plbr{0}}
        + \alpha_1 x_{na-1}^{\plbr{1}} + \beta_1 u^{\plbr{1}} \\
	& & \mbox{} + {\ldots} 
	+ \alpha_{na-2} x_{na-1}^{\plbr{na-2}} + \beta_{na-2} u^{\plbr{na-2}} \\
	& & \mbox{}
	+ \alpha_{na-1} x_{na-1}^{\plbr{na-1}} + \beta_{na-1} u^{\plbr{na-1}}
\end{eqnarray*}
and, by considering that 
\begin{displaymath}
    x_{na-1} \ = \ y - \beta_{na} u
\end{displaymath}
and that
\begin{displaymath}
    x_{na-1}^{\plbr{j}} \ = \ y^{\plbr{j}} - \beta_{na} u^{\plbr{j}}
\end{displaymath}
the relation 
\begin{eqnarray*}
    \lefteqn{
        y^{\plbr{na}} - \alpha_{na-1} y^{\plbr{na-1}}
	- {\ldots} - \alpha_1 y^{\plbr{1}} - \alpha_0 y^{\plbr{0}}
    } \\
    & = & \beta_{na} u^{\plbr{na}} 
    + \plbr{\beta_{na-1}-\alpha_{na-1}\beta_{na}} u^{\plbr{na-1}} 
    + {\ldots} \\
    & & \mbox{}
    + \plbr{\beta_1-\alpha_1\beta_{na}} u^{\plbr{1}}
    + \plbr{\beta_0-\alpha_0\beta_{na}} u^{\plbr{0}}
\end{eqnarray*}
which corresponds to the initial equation by setting
\begin{eqnarray*}
    \alpha_i & = & \frac{a_i}{a_{na}} \\
    \beta_{na} & = & \frac{b_{na}}{a_{na}} \\
    \beta_i & = & \frac{b_i}{a_{na}} + \alpha_i \beta_{na}
\end{eqnarray*}

\end{document}
